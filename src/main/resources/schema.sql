DROP TABLE IF EXISTS users,requests,items,bookings,comments;

CREATE TABLE IF NOT EXISTS users (
    ID INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    NAME VARCHAR(255),
    EMAIL VARCHAR(255) UNIQUE
);

CREATE TABLE IF NOT EXISTS requests (
    ID INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    DESCRIPTION VARCHAR(1000) ,
    REQUESTER_ID INTEGER REFERENCES users(ID) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS items (
    ID INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    NAME VARCHAR(255) ,
    DESCRIPTION VARCHAR(1000) ,
    IS_AVAILABLE BOOLEAN,
    OWNER_ID INTEGER REFERENCES users(ID) ON DELETE CASCADE,
    REQUEST_ID INTEGER REFERENCES requests(ID) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS bookings (
    ID INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    START_DATE TIMESTAMP WITH TIME ZONE ,
    END_DATE TIMESTAMP WITH TIME ZONE ,
    ITEM_ID INTEGER REFERENCES items(ID) ON DELETE CASCADE,
    BOOKER_ID INTEGER REFERENCES users(ID) ON DELETE CASCADE,
    STATUS VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS comments (
    ID INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    TEXT VARCHAR(1000) ,
    ITEM_ID INTEGER REFERENCES items(ID) ON DELETE CASCADE,
    AUTHOR_ID INTEGER REFERENCES users(ID) ON DELETE CASCADE,
    CREATED TIMESTAMP WITH TIME ZONE
);